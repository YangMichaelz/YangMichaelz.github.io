window.onload=function(){setTimeout(C)};function C(){function R(e,i,t,o){var a=e+t*Math.cos(o),r=i+t*Math.sin(o);return{x:a,y:r}}function s(e,i){return e+Math.random()*(i-e)}function y(e){return e/180*Math.PI}for(var p={x:0,y:0,vx:0,vy:0,radius:0,create:function(e,i,t,o){var a=Object.create(this);return a.x=e,a.y=i,a.vx=Math.cos(o)*t,a.vy=Math.sin(o)*t,a},getSpeed:function(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)},setSpeed:function(e){var i=this.getHeading();this.vx=Math.cos(i)*e,this.vy=Math.sin(i)*e},getHeading:function(){return Math.atan2(this.vy,this.vx)},setHeading:function(e){var i=this.getSpeed();this.vx=Math.cos(e)*i,this.vy=Math.sin(e)*i},update:function(){this.x+=this.vx,this.y+=this.vy}},c=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),u=document.getElementById("canvas"),n=u.getContext("2d"),l=u.width=window.outerWidth,c=u.height=c,h=[],d=[],f=[{speed:.015,scale:.2,count:320},{speed:.03,scale:.5,count:50},{speed:.05,scale:.75,count:30}],m=145,x={min:5,max:10},H=.01,S=.01,b=900,E=1e3,D=300,T=2,L=3,g=!1,w=0;w<f.length;w+=1)for(var M=f[w],P=0;P<M.count;P+=1){var v=p.create(s(0,l),s(0,c),0,0);v.radius=T*M.scale,v.setSpeed(M.speed),v.setHeading(y(m)),h.push(v)}function B(){var e=p.create(s(l/2,l),s(0,c/2),0,0);e.setSpeed(s(x.min,x.max)),e.setHeading(y(m)),e.radius=L,e.opacity=0,e.trailLengthDelta=0,e.isSpawning=!0,e.isDying=!1,d.push(e)}function A(e){setTimeout(function(){e.isDying=!0},E)}function I(){if(l!=window.outerWidth||c!=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)){u=document.getElementById("canvas"),n=u.getContext("2d"),l=u.width=window.outerWidth,c=u.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),h=[],d=[],f=[{speed:.015,scale:.2,count:320},{speed:.03,scale:.5,count:50},{speed:.05,scale:.75,count:30}],m=145,x={min:5,max:10},H=.01,S=.01,b=900,E=1e3,D=300,T=2,L=3,g=!1;for(var e=0;e<f.length;e+=1)for(var i=f[e],t=0;t<i.count;t+=1){var o=p.create(s(0,l),s(0,c),0,0);o.radius=T*i.scale,o.setSpeed(i.speed),o.setHeading(y(m)),h.push(o)}}if(!g){n.clearRect(0,0,l,c),n.fillStyle="#22223B",n.fillRect(0,0,l,c),n.fill();for(var t=0;t<h.length;t+=1){var o=h[t];o.update(),W(o),o.x>l&&(o.x=0),o.x<0&&(o.x=l),o.y>c&&(o.y=0),o.y<0&&(o.y=c)}for(t=0;t<d.length;t+=1){var a=d[t];a.isSpawning&&(a.opacity+=H,a.opacity>=1&&(a.isSpawning=!1,A(a))),a.isDying&&(a.opacity-=H,a.opacity<=0&&(a.isDying=!1,a.isDead=!0)),a.trailLengthDelta+=S,a.update(),a.opacity>0&&q(a)}for(t=d.length-1;t>=0;t--)d[t].isDead&&d.splice(t,1)}requestAnimationFrame(I)}function W(e){n.fillStyle="#F2E9E4",n.beginPath(),n.arc(e.x,e.y,e.radius,0,Math.PI*2,!1),n.fill()}function q(e){var i=e.x,t=e.y,o=D*e.trailLengthDelta,a=R(i,t,-o,e.getHeading());n.fillStyle="rgba(255, 255, 255, "+e.opacity+")";var r=5;n.beginPath(),n.moveTo(i-1,t+1),n.lineTo(i,t+r),n.lineTo(i+1,t+1),n.lineTo(i+r,t),n.lineTo(i+1,t-1),n.lineTo(i,t+1),n.lineTo(i,t-r),n.lineTo(i-1,t-1),n.lineTo(i-r,t),n.lineTo(i-1,t+1),n.lineTo(i-r,t),n.closePath(),n.fill(),n.fillStyle="rgba(255, 221, 157, "+e.opacity+")",n.beginPath(),n.moveTo(i-1,t-1),n.lineTo(a.x,a.y),n.lineTo(i+1,t+1),n.closePath(),n.fill()}I(),setInterval(function(){g||B()},b),window.onfocus=function(){g=!1},window.onblur=function(){g=!0}}
